# Лабораторная работа № 3 Разработка безопасных веб-приложений
> Выполнили студенты группы РИ-571227 Мартынов Артём, Бушуев Антон

Для проверки уязвимостей через cookie была создана куки с некорректным пользователем:

![Image alt](https://github.com/ArtemMartynov/screens/raw/main/LR_3_Web_screen_1.png)

Для проверки хранимого XSS при создании книги добавлялся HTML код <b></b>:

![Image alt](https://github.com/ArtemMartynov/screens/raw/main/LR_3_Web_screen_2.png)

И, наконец, для проверки отражённого XSS использовался тот же <b></b>, однако из-за сразу включённого фильтра в booklist.pug HTML-код не выполнился:

![Image alt](https://github.com/ArtemMartynov/screens/raw/main/LR_3_Web_screen_3.png)

Для его выполнения отражённого XSS пришлось отключить фильтр (после проверки он, конечно, был включен обратно):

![Image alt](https://github.com/ArtemMartynov/screens/raw/main/LR_3_Web_screen_4.png)

Для исправления уязвимостей было проделано следующее:
  - Включен обратно фильтр в файле booklist.pug для защиты от отражённого XSS;
  - Там же включена фильтрация на столбец с названиями книг, что позволило защититься от хранимого XSS;
  - Для куки включена опция HTTPOnly;
  - Также для куки была произведена проверка по имени пользователя в хранимой куки, если имя от куки не совпадает с именем из БД, то пользователя пересылает на страницу входа;

В результате отражённый XSS более не работает (видно на скринах выше). Хранимый XSS также не действует:

![Image alt](https://github.com/ArtemMartynov/screens/raw/main/LR_3_Web_screen_5.png)

Перехват сессии через некорректные куки также больше не работает:

![Image alt](https://github.com/ArtemMartynov/screens/raw/main/LR_3_Web_screen_6.png)
